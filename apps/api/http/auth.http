### Authentication API Tests
# REST Client extension for VS Code required
# Click "Send Request" to execute each test

@baseUrl = http://localhost:5001/api
@contentType = application/json

### Health Check
GET {{baseUrl}}/health

###
# REGISTRATION TESTS
###

### Register New User (use unique timestamp email)
POST {{baseUrl}}/auth/register
Content-Type: {{contentType}}

{
  "email": "user{{$timestamp}}@example.com",
  "name": "Test User",
  "password": "SecurePass123!"
}

### Register Fixed User (first time: 201, second time: 409)
POST {{baseUrl}}/auth/register
Content-Type: {{contentType}}

{
  "email": "test@example.com",
  "name": "Test User",
  "password": "TestPass123!"
}

### Register with Weak Password (should fail)
POST {{baseUrl}}/auth/register
Content-Type: {{contentType}}

{
  "email": "weak@example.com",
  "name": "Weak User",
  "password": "123"
}

###
# LOGIN TESTS
###

### Login with Fixed User (run after registering test@example.com)
# @name login
POST {{baseUrl}}/auth/login
Content-Type: {{contentType}}

{
  "email": "test@example.com",
  "password": "TestPass123!"
}

### Login with Wrong Password (should fail)
POST {{baseUrl}}/auth/login
Content-Type: {{contentType}}

{
  "email": "test@example.com",
  "password": "WrongPass123!"
}

### Login with Non-existent User (should fail)
POST {{baseUrl}}/auth/login
Content-Type: {{contentType}}

{
  "email": "doesnotexist@example.com",
  "password": "SomePass123!"
}

###
# AUTHENTICATED ENDPOINTS
###

### Get Current User (needs login token)
GET {{baseUrl}}/auth/me
Authorization: Bearer {{login.response.body.token}}

### Get Current User WITHOUT Token (should fail)
GET {{baseUrl}}/auth/me

### Get Current User with INVALID Token (should fail)
GET {{baseUrl}}/auth/me
Authorization: Bearer invalid.token.here
